{% extends "base.html" %}

{% block title %}New Project - HITL Research Strategy Pipeline{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto animate-slide-in">
    <!-- Progress breadcrumb -->
    <nav class="mb-8" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-2 text-sm text-gray-500">
            <li><a href="/" class="hover:text-gray-700">Projects</a></li>
            <li><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></li>
            <li class="text-gray-900 font-medium">New Project</li>
        </ol>
    </nav>

    <div class="bg-white rounded-lg shadow-sm p-8">
        <div class="mb-8">
            <h1 class="text-2xl font-bold text-gray-900 mb-2">
                Start Your Research Strategy
            </h1>
            <p class="text-gray-600">
                Begin by describing your research idea. Don't worry about being perfect—we'll refine it together through the pipeline.
            </p>
        </div>

        {% if error %}
        <div class="mb-6 bg-red-50 border border-red-200 rounded-lg p-4">
            <div class="flex">
                <svg class="w-5 h-5 text-red-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                </svg>
                <p class="text-sm text-red-700">{{ error }}</p>
            </div>
        </div>
        {% endif %}

        <form method="POST" action="/project/new"
              hx-post="/project/new"
              hx-indicator="#loading"
              class="space-y-6">

            <!-- Main idea input -->
            <div>
                <label for="raw_idea" class="block text-sm font-medium text-gray-700 mb-2">
                    Research Idea
                    <span class="text-red-500">*</span>
                </label>
                <textarea
                    id="raw_idea"
                    name="raw_idea"
                    rows="6"
                    required
                    placeholder="Example: I want to investigate how remote work affects team collaboration and innovation in software development companies. I'm interested in both quantitative productivity metrics and qualitative aspects like team cohesion and creativity."
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
                    x-data="{ count: 0 }"
                    x-on:input="count = $el.value.length"
                    maxlength="2000"
                ></textarea>
                <div class="mt-2 flex justify-between items-center text-sm text-gray-500">
                    <span>Be as specific or as broad as you like—we'll help you refine it.</span>
                    <span x-text="count + ' / 2000'">0 / 2000</span>
                </div>
            </div>

            <!-- Helper tips -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                <h3 class="text-sm font-semibold text-blue-900 mb-2 flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                    Tips for a good starting idea
                </h3>
                <ul class="text-sm text-blue-800 space-y-1">
                    <li>• Mention your domain or field (e.g., healthcare, education, computer science)</li>
                    <li>• Include what you want to understand, compare, or evaluate</li>
                    <li>• Note any specific populations, contexts, or constraints</li>
                    <li>• Don't worry about research questions yet—we'll help you develop those</li>
                </ul>
            </div>

            <!-- Action buttons -->
            <div class="flex items-center justify-between pt-6 border-t border-gray-200">
                <a href="/" class="text-gray-600 hover:text-gray-900">
                    Cancel
                </a>
                <div class="flex items-center space-x-4">
                    <!-- Loading indicator -->
                    <div id="loading" class="htmx-indicator flex items-center text-blue-600">
                        <svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        Creating project...
                    </div>

                    <button
                        type="submit"
                        class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        Create Project & Continue
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Example projects showcase -->
    <div class="mt-8 bg-gray-100 rounded-lg p-6" x-data="{ expanded: false }">
        <button
            @click="expanded = !expanded"
            class="w-full flex items-center justify-between text-left"
        >
            <h3 class="text-lg font-semibold text-gray-900">Example Ideas</h3>
            <svg
                class="w-5 h-5 text-gray-500 transition-transform"
                :class="{ 'rotate-180': expanded }"
                fill="none" stroke="currentColor" viewBox="0 0 24 24"
            >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
        </button>

        <div x-show="expanded" x-transition class="mt-4 space-y-3">
            <div class="bg-white rounded-lg p-4 border border-gray-200">
                <h4 class="font-medium text-gray-900 mb-1">Healthcare AI Ethics</h4>
                <p class="text-sm text-gray-600">"Investigating ethical considerations and bias mitigation strategies in AI-powered diagnostic tools for cancer detection in diverse patient populations."</p>
            </div>
            <div class="bg-white rounded-lg p-4 border border-gray-200">
                <h4 class="font-medium text-gray-900 mb-1">Education Technology</h4>
                <p class="text-sm text-gray-600">"Exploring the effectiveness of gamification in online learning platforms for K-12 mathematics education, focusing on engagement and learning outcomes."</p>
            </div>
            <div class="bg-white rounded-lg p-4 border border-gray-200">
                <h4 class="font-medium text-gray-900 mb-1">Climate Policy</h4>
                <p class="text-sm text-gray-600">"Comparing carbon pricing mechanisms across different countries and their impact on industrial emissions reduction over the past decade."</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

